242ca00d7adf9190435d4aeb681e7f60













'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined;}else{return get(parent,property,receiver);}}else if("value"in desc){return desc.value;}else{var getter=desc.get;if(getter===undefined){return undefined;}return getter.call(receiver);}};var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}

var AnimatedNode=require('./AnimatedNode');
var AnimatedWithChildren=require('./AnimatedWithChildren');
var NativeAnimatedHelper=require('../NativeAnimatedHelper');

var invariant=require('fbjs/lib/invariant');
var normalizeColor=require('normalizeColor');
















var linear=function linear(t){return t;};





function createInterpolation(
config)
{
if(config.outputRange&&typeof config.outputRange[0]==='string'){
return createInterpolationFromStringOutputRange(config);
}

var outputRange=config.outputRange;
checkInfiniteRange('outputRange',outputRange);

var inputRange=config.inputRange;
checkInfiniteRange('inputRange',inputRange);
checkValidInputRange(inputRange);

invariant(
inputRange.length===outputRange.length,
'inputRange ('+
inputRange.length+
') and outputRange ('+
outputRange.length+
') must have the same length');


var easing=config.easing||linear;

var extrapolateLeft='extend';
if(config.extrapolateLeft!==undefined){
extrapolateLeft=config.extrapolateLeft;
}else if(config.extrapolate!==undefined){
extrapolateLeft=config.extrapolate;
}

var extrapolateRight='extend';
if(config.extrapolateRight!==undefined){
extrapolateRight=config.extrapolateRight;
}else if(config.extrapolate!==undefined){
extrapolateRight=config.extrapolate;
}

return function(input){
invariant(
typeof input==='number',
'Cannot interpolation an input which is not a number');


var range=findRange(input,inputRange);
return interpolate(
input,
inputRange[range],
inputRange[range+1],
outputRange[range],
outputRange[range+1],
easing,
extrapolateLeft,
extrapolateRight);

};
}

function interpolate(
input,
inputMin,
inputMax,
outputMin,
outputMax,
easing,
extrapolateLeft,
extrapolateRight)
{
var result=input;


if(result<inputMin){
if(extrapolateLeft==='identity'){
return result;
}else if(extrapolateLeft==='clamp'){
result=inputMin;
}else if(extrapolateLeft==='extend'){

}
}

if(result>inputMax){
if(extrapolateRight==='identity'){
return result;
}else if(extrapolateRight==='clamp'){
result=inputMax;
}else if(extrapolateRight==='extend'){

}
}

if(outputMin===outputMax){
return outputMin;
}

if(inputMin===inputMax){
if(input<=inputMin){
return outputMin;
}
return outputMax;
}


if(inputMin===-Infinity){
result=-result;
}else if(inputMax===Infinity){
result=result-inputMin;
}else{
result=(result-inputMin)/(inputMax-inputMin);
}


result=easing(result);


if(outputMin===-Infinity){
result=-result;
}else if(outputMax===Infinity){
result=result+outputMin;
}else{
result=result*(outputMax-outputMin)+outputMin;
}

return result;
}

function colorToRgba(input){
var int32Color=normalizeColor(input);
if(int32Color===null){
return input;
}

int32Color=int32Color||0;

var r=(int32Color&0xff000000)>>>24;
var g=(int32Color&0x00ff0000)>>>16;
var b=(int32Color&0x0000ff00)>>>8;
var a=(int32Color&0x000000ff)/255;

return'rgba('+r+', '+g+', '+b+', '+a+')';
}

var stringShapeRegex=/[0-9\.-]+/g;









function createInterpolationFromStringOutputRange(
config)
{
var outputRange=config.outputRange;
invariant(outputRange.length>=2,'Bad output range');
outputRange=outputRange.map(colorToRgba);
checkPattern(outputRange);












var outputRanges=outputRange[0].match(stringShapeRegex).map(function(){return[];});
outputRange.forEach(function(value){



value.match(stringShapeRegex).forEach(function(number,i){
outputRanges[i].push(+number);
});
});




var interpolations=outputRange[0].
match(stringShapeRegex).
map(function(value,i){
return createInterpolation(_extends({},
config,{
outputRange:outputRanges[i]}));

});



var shouldRound=isRgbOrRgba(outputRange[0]);

return function(input){
var i=0;



return outputRange[0].replace(stringShapeRegex,function(){
var val=+interpolations[i++](input);
var rounded=
shouldRound&&i<4?Math.round(val):Math.round(val*1000)/1000;
return String(rounded);
});
};
}

function isRgbOrRgba(range){
return typeof range==='string'&&range.startsWith('rgb');
}

function checkPattern(arr){
var pattern=arr[0].replace(stringShapeRegex,'');
for(var i=1;i<arr.length;++i){
invariant(
pattern===arr[i].replace(stringShapeRegex,''),
'invalid pattern '+arr[0]+' and '+arr[i]);

}
}

function findRange(input,inputRange){
var i=void 0;
for(i=1;i<inputRange.length-1;++i){
if(inputRange[i]>=input){
break;
}
}
return i-1;
}

function checkValidInputRange(arr){
invariant(arr.length>=2,'inputRange must have at least 2 elements');
for(var i=1;i<arr.length;++i){
invariant(
arr[i]>=arr[i-1],






'inputRange must be monotonically increasing '+arr);

}
}

function checkInfiniteRange(name,arr){
invariant(arr.length>=2,name+' must have at least 2 elements');
invariant(
arr.length!==2||arr[0]!==-Infinity||arr[1]!==Infinity,






name+'cannot be ]-infinity;+infinity[ '+arr);

}var

AnimatedInterpolation=function(_AnimatedWithChildren){_inherits(AnimatedInterpolation,_AnimatedWithChildren);







function AnimatedInterpolation(parent,config){_classCallCheck(this,AnimatedInterpolation);var _this=_possibleConstructorReturn(this,(AnimatedInterpolation.__proto__||Object.getPrototypeOf(AnimatedInterpolation)).call(this));

_this._parent=parent;
_this._config=config;
_this._interpolation=createInterpolation(config);return _this;
}_createClass(AnimatedInterpolation,[{key:'__makeNative',value:function __makeNative()

{
this._parent.__makeNative();
_get(AnimatedInterpolation.prototype.__proto__||Object.getPrototypeOf(AnimatedInterpolation.prototype),'__makeNative',this).call(this);
}},{key:'__getValue',value:function __getValue()

{
var parentValue=this._parent.__getValue();
invariant(
typeof parentValue==='number',
'Cannot interpolate an input which is not a number.');

return this._interpolation(parentValue);
}},{key:'interpolate',value:function interpolate(

config){
return new AnimatedInterpolation(this,config);
}},{key:'__attach',value:function __attach()

{
this._parent.__addChild(this);
}},{key:'__detach',value:function __detach()

{
this._parent.__removeChild(this);
_get(AnimatedInterpolation.prototype.__proto__||Object.getPrototypeOf(AnimatedInterpolation.prototype),'__detach',this).call(this);
}},{key:'__transformDataType',value:function __transformDataType(

range){


return range.map(function(value){
if(typeof value!=='string'){
return value;
}
if(/deg$/.test(value)){
var degrees=parseFloat(value)||0;
var radians=degrees*Math.PI/180.0;
return radians;
}else{

return parseFloat(value)||0;
}
});
}},{key:'__getNativeConfig',value:function __getNativeConfig()

{
if(__DEV__){
NativeAnimatedHelper.validateInterpolation(this._config);
}

return{
inputRange:this._config.inputRange,

outputRange:this.__transformDataType(this._config.outputRange),
extrapolateLeft:
this._config.extrapolateLeft||this._config.extrapolate||'extend',
extrapolateRight:
this._config.extrapolateRight||this._config.extrapolate||'extend',
type:'interpolation'};

}}]);return AnimatedInterpolation;}(AnimatedWithChildren);AnimatedInterpolation.__createInterpolation=createInterpolation;


module.exports=AnimatedInterpolation;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFuaW1hdGVkSW50ZXJwb2xhdGlvbi5qcyJdLCJuYW1lcyI6WyJBbmltYXRlZE5vZGUiLCJyZXF1aXJlIiwiQW5pbWF0ZWRXaXRoQ2hpbGRyZW4iLCJOYXRpdmVBbmltYXRlZEhlbHBlciIsImludmFyaWFudCIsIm5vcm1hbGl6ZUNvbG9yIiwibGluZWFyIiwidCIsImNyZWF0ZUludGVycG9sYXRpb24iLCJjb25maWciLCJvdXRwdXRSYW5nZSIsImNyZWF0ZUludGVycG9sYXRpb25Gcm9tU3RyaW5nT3V0cHV0UmFuZ2UiLCJjaGVja0luZmluaXRlUmFuZ2UiLCJpbnB1dFJhbmdlIiwiY2hlY2tWYWxpZElucHV0UmFuZ2UiLCJsZW5ndGgiLCJlYXNpbmciLCJleHRyYXBvbGF0ZUxlZnQiLCJ1bmRlZmluZWQiLCJleHRyYXBvbGF0ZSIsImV4dHJhcG9sYXRlUmlnaHQiLCJpbnB1dCIsInJhbmdlIiwiZmluZFJhbmdlIiwiaW50ZXJwb2xhdGUiLCJpbnB1dE1pbiIsImlucHV0TWF4Iiwib3V0cHV0TWluIiwib3V0cHV0TWF4IiwicmVzdWx0IiwiSW5maW5pdHkiLCJjb2xvclRvUmdiYSIsImludDMyQ29sb3IiLCJyIiwiZyIsImIiLCJhIiwic3RyaW5nU2hhcGVSZWdleCIsIm1hcCIsImNoZWNrUGF0dGVybiIsIm91dHB1dFJhbmdlcyIsIm1hdGNoIiwiZm9yRWFjaCIsInZhbHVlIiwibnVtYmVyIiwiaSIsInB1c2giLCJpbnRlcnBvbGF0aW9ucyIsInNob3VsZFJvdW5kIiwiaXNSZ2JPclJnYmEiLCJyZXBsYWNlIiwidmFsIiwicm91bmRlZCIsIk1hdGgiLCJyb3VuZCIsIlN0cmluZyIsInN0YXJ0c1dpdGgiLCJhcnIiLCJwYXR0ZXJuIiwibmFtZSIsIkFuaW1hdGVkSW50ZXJwb2xhdGlvbiIsInBhcmVudCIsIl9wYXJlbnQiLCJfY29uZmlnIiwiX2ludGVycG9sYXRpb24iLCJfX21ha2VOYXRpdmUiLCJwYXJlbnRWYWx1ZSIsIl9fZ2V0VmFsdWUiLCJfX2FkZENoaWxkIiwiX19yZW1vdmVDaGlsZCIsInRlc3QiLCJkZWdyZWVzIiwicGFyc2VGbG9hdCIsInJhZGlhbnMiLCJQSSIsIl9fREVWX18iLCJ2YWxpZGF0ZUludGVycG9sYXRpb24iLCJfX3RyYW5zZm9ybURhdGFUeXBlIiwidHlwZSIsIl9fY3JlYXRlSW50ZXJwb2xhdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFhQSxhOztBQUVBLEdBQU1BLGNBQWVDLFFBQVEsZ0JBQVIsQ0FBckI7QUFDQSxHQUFNQyxzQkFBdUJELFFBQVEsd0JBQVIsQ0FBN0I7QUFDQSxHQUFNRSxzQkFBdUJGLFFBQVEseUJBQVIsQ0FBN0I7O0FBRUEsR0FBTUcsV0FBWUgsUUFBUSxvQkFBUixDQUFsQjtBQUNBLEdBQU1JLGdCQUFpQkosUUFBUSxnQkFBUixDQUF2Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpQkEsR0FBTUssUUFBUyxRQUFUQSxPQUFTLFVBQUtDLEVBQUwsRUFBZjs7Ozs7O0FBTUEsUUFBU0Msb0JBQVQ7QUFDRUMsTUFERjtBQUVzQztBQUNwQyxHQUFJQSxPQUFPQyxXQUFQLEVBQXNCLE1BQU9ELFFBQU9DLFdBQVAsQ0FBbUIsQ0FBbkIsQ0FBUCxHQUFpQyxRQUEzRCxDQUFxRTtBQUNuRSxNQUFPQywwQ0FBeUNGLE1BQXpDLENBQVA7QUFDRDs7QUFFRCxHQUFNQyxhQUE4QkQsT0FBT0MsV0FBM0M7QUFDQUUsbUJBQW1CLGFBQW5CLENBQWtDRixXQUFsQzs7QUFFQSxHQUFNRyxZQUFhSixPQUFPSSxVQUExQjtBQUNBRCxtQkFBbUIsWUFBbkIsQ0FBaUNDLFVBQWpDO0FBQ0FDLHFCQUFxQkQsVUFBckI7O0FBRUFUO0FBQ0VTLFdBQVdFLE1BQVgsR0FBc0JMLFlBQVlLLE1BRHBDO0FBRUU7QUFDRUYsV0FBV0UsTUFEYjtBQUVFLHFCQUZGO0FBR0VMLFlBQVlLLE1BSGQ7QUFJRSw2QkFOSjs7O0FBU0EsR0FBTUMsUUFBU1AsT0FBT08sTUFBUCxFQUFpQlYsTUFBaEM7O0FBRUEs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VUFEcEI7O0FBR0xILFlBQWEsS0FBS21FLG1CQUFMLENBQXlCLEtBQUtkLE9BQUwsQ0FBYXJELFdBQXRDLENBSFI7QUFJTE87QUFDRSxLQUFLOEMsT0FBTCxDQUFhOUMsZUFBYixFQUFnQyxLQUFLOEMsT0FBTCxDQUFhNUMsV0FBN0MsRUFBNEQsUUFMekQ7QUFNTEM7QUFDRSxLQUFLMkMsT0FBTCxDQUFhM0MsZ0JBQWIsRUFBaUMsS0FBSzJDLE9BQUwsQ0FBYTVDLFdBQTlDLEVBQTZELFFBUDFEO0FBUUwyRCxLQUFNLGVBUkQsQ0FBUDs7QUFVRCxDLG1DQTNFaUM1RSxvQixFQUE5QjBELHFCLENBRUdtQixxQixDQUF3QnZFLG1COzs7QUE0RWpDd0UsT0FBT0MsT0FBUCxDQUFpQnJCLHFCQUFqQiIsImZpbGUiOiJBbmltYXRlZEludGVycG9sYXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIEFuaW1hdGVkSW50ZXJwb2xhdGlvblxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuLyogZXNsaW50IG5vLWJpdHdpc2U6IDAgKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgQW5pbWF0ZWROb2RlID0gcmVxdWlyZSgnLi9BbmltYXRlZE5vZGUnKTtcbmNvbnN0IEFuaW1hdGVkV2l0aENoaWxkcmVuID0gcmVxdWlyZSgnLi9BbmltYXRlZFdpdGhDaGlsZHJlbicpO1xuY29uc3QgTmF0aXZlQW5pbWF0ZWRIZWxwZXIgPSByZXF1aXJlKCcuLi9OYXRpdmVBbmltYXRlZEhlbHBlcicpO1xuXG5jb25zdCBpbnZhcmlhbnQgPSByZXF1aXJlKCdmYmpzL2xpYi9pbnZhcmlhbnQnKTtcbmNvbnN0IG5vcm1hbGl6ZUNvbG9yID0gcmVxdWlyZSgnbm9ybWFsaXplQ29sb3InKTtcblxudHlwZSBFeHRyYXBvbGF0ZVR5cGUgPSAnZXh0ZW5kJyB8ICdpZGVudGl0eScgfCAnY2xhbXAnO1xuXG5leHBvcnQgdHlwZSBJbnRlcnBvbGF0aW9uQ29uZmlnVHlwZSA9IHtcbiAgaW5wdXRSYW5nZTogQXJyYXk8bnVtYmVyPixcbiAgLyogJEZsb3dGaXhNZSg+PTAuMzguMCBzaXRlPXJlYWN0X25hdGl2ZV9mYixyZWFjdF9uYXRpdmVfb3NzKSAtIEZsb3cgZXJyb3JcbiAgICogZGV0ZWN0ZWQgZHVyaW5nIHRoZSBkZXBsb3ltZW50IG9mIHYwLjM4LjAuIFRvIHNlZSB0aGUgZXJyb3IsIHJlbW92ZSB0aGlzXG4gICAqIGNvbW1lbnQgYW5kIHJ1biBmbG93XG4gICAqL1xuICBvdXRwdXRSYW5nZTogQXJyYXk8bnVtYmVyPiB8IEFycmF5PHN0cmluZz4sXG4gIGVhc2luZz86IChpbnB1dDogbnVtYmVyKSA9PiBudW1iZXIsXG4gIGV4dHJhcG9sYXRlPzogRXh0cmFwb2xhdGVUeXBlLFxuICBleHRyYXBvbGF0ZUxlZnQ/OiBFeHRyYXBvbGF0ZVR5cGUsXG4gIGV4dHJhcG9sYXRlUmlnaHQ/OiBFeHRyYXBvbGF0ZVR5cGUsXG59O1xuXG5jb25zdCBsaW5lYXIgPSB0ID0+IHQ7XG5cbi8qKlxuICogVmVyeSBoYW5keSBoZWxwZXIgdG8gbWFwIGlucHV0IHJhbmdlcyB0byBvdXRwdXQgcmFuZ2VzIHdpdGggYW4gZWFzaW5nXG4gKiBmdW5jdGlvbiBhbmQgY3VzdG9tIGJlaGF2aW9yIG91dHNpZGUgb2YgdGhlIHJhbmdlcy5cbiAqL1xuZnVuY3Rpb24gY3JlYXRlSW50ZXJwb2xhdGlvbihcbiAgY29uZmlnOiBJbnRlcnBvbGF0aW9uQ29uZmlnVHlwZSxcbik6IChpbnB1dDogbnVtYmVyKSA9PiBudW1iZXIgfCBzdHJpbmcge1xuICBpZiAoY29uZmlnLm91dHB1dFJhbmdlICYmIHR5cGVvZiBjb25maWcub3V0cHV0UmFuZ2VbMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGNyZWF0ZUludGVycG9sYXRpb25Gcm9tU3RyaW5nT3V0cHV0UmFuZ2UoY29uZmlnKTtcbiAgfVxuXG4gIGNvbnN0IG91dHB1dFJhbmdlOiBBcnJheTxudW1iZXI+ID0gKGNvbmZpZy5vdXRwdXRSYW5nZTogYW55KTtcbiAgY2hlY2tJbmZpbml0ZVJhbmdlKCdvdXRwdXRSYW5nZScsIG91dHB1dFJhbmdlKTtcblxuICBjb25zdCBpbnB1dFJhbmdlID0gY29uZmlnLmlucHV0UmFuZ2U7XG4gIGNoZWNrSW5maW5pdGVSYW5nZSgnaW5wdXRSYW5nZScsIGlucHV0UmFuZ2UpO1xuICBjaGVja1ZhbGlkSW5wdXRSYW5nZShpbnB1dFJhbmdlKTtcblxuICBpbnZhcmlhbnQoXG4gICAgaW5wdXRSYW5nZS5sZW5ndGggPT09IG91dHB1dFJhbmdlLmxlbmd0aCxcbiAgICAnaW5wdXRSYW5nZSAoJyArXG4gICAgICBpbnB1dFJhbmdlLmxlbmd0aCArXG4gICAgICAnKSBhbmQgb3V0cHV0UmFuZ2UgKCcgK1xuICAgICAgb3V0cHV0UmFuZ2UubGVuZ3RoICtcbiAgICAgICcpIG11c3QgaGF2ZSB0aGUgc2FtZSBsZW5ndGgnLFxuICApO1xuXG4gIGNvbnN0IGVhc2luZyA9IGNvbmZpZy5lYXNpbmcgfHwgbGluZWFyO1xuXG4gIGxldCBleHRyYXBvbGF0ZUxlZnQ6IEV4dHJhcG9sYXRlVHlwZSA9ICdleHRlbmQnO1xuICBpZiAoY29uZmlnLmV4dHJhcG9sYXRlTGVmdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZXh0cmFwb2xhdGVMZWZ0ID0gY29uZmlnLmV4dHJhcG9sYXRlTGVmdDtcbiAgfSBlbHNlIGlmIChjb25maWcuZXh0cmFwb2xhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGV4dHJhcG9sYXRlTGVmdCA9IGNvbmZpZy5leHRyYXBvbGF0ZTtcbiAgfVxuXG4gIGxldCBleHRyYXBvbGF0ZVJpZ2h0OiBFeHRyYXBvbGF0ZVR5cGUgPSAnZXh0ZW5kJztcbiAgaWYgKGNvbmZpZy5leHRyYXBvbGF0ZVJpZ2h0ICE9PSB1bmRlZmluZWQpIHtcbiAgICBleHRyYXBvbGF0ZVJpZ2h0ID0gY29uZmlnLmV4dHJhcG9sYXRlUmlnaHQ7XG4gIH0gZWxzZSBpZiAoY29uZmlnLmV4dHJhcG9sYXRlICE9PSB1bmRlZmluZWQpIHtcbiAgICBleHRyYXBvbGF0ZVJpZ2h0ID0gY29uZmlnLmV4dHJhcG9sYXRlO1xuICB9XG5cbiAgcmV0dXJuIGlucHV0ID0+IHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICB0eXBlb2YgaW5wdXQgPT09ICdudW1iZXInLFxuICAgICAgJ0Nhbm5vdCBpbnRlcnBvbGF0aW9uIGFuIGlucHV0IHdoaWNoIGlzIG5vdCBhIG51bWJlcicsXG4gICAgKTtcblxuICAgIGNvbnN0IHJhbmdlID0gZmluZFJhbmdlKGlucHV0LCBpbnB1dFJhbmdlKTtcbiAgICByZXR1cm4gaW50ZXJwb2xhdGUoXG4gICAgICBpbnB1dCxcbiAgICAgIGlucHV0UmFuZ2VbcmFuZ2VdLFxuICAgICAgaW5wdXRSYW5nZVtyYW5nZSArIDFdLFxuICAgICAgb3V0cHV0UmFuZ2VbcmFuZ2VdLFxuICAgICAgb3V0cHV0UmFuZ2VbcmFuZ2UgKyAxXSxcbiAgICAgIGVhc2luZyxcbiAgICAgIGV4dHJhcG9sYXRlTGVmdCxcbiAgICAgIGV4dHJhcG9sYXRlUmlnaHQsXG4gICAgKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gaW50ZXJwb2xhdGUoXG4gIGlucHV0OiBudW1iZXIsXG4gIGlucHV0TWluOiBudW1iZXIsXG4gIGlucHV0TWF4OiBudW1iZXIsXG4gIG91dHB1dE1pbjogbnVtYmVyLFxuICBvdXRwdXRNYXg6IG51bWJlcixcbiAgZWFzaW5nOiAoaW5wdXQ6IG51bWJlcikgPT4gbnVtYmVyLFxuICBleHRyYXBvbGF0ZUxlZnQ6IEV4dHJhcG9sYXRlVHlwZSxcbiAgZXh0cmFwb2xhdGVSaWdodDogRXh0cmFwb2xhdGVUeXBlLFxuKSB7XG4gIGxldCByZXN1bHQgPSBpbnB1dDtcblxuICAvLyBFeHRyYXBvbGF0ZVxuICBpZiAocmVzdWx0IDwgaW5wdXRNaW4pIHtcbiAgICBpZiAoZXh0cmFwb2xhdGVMZWZ0ID09PSAnaWRlbnRpdHknKSB7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSBpZiAoZXh0cmFwb2xhdGVMZWZ0ID09PSAnY2xhbXAnKSB7XG4gICAgICByZXN1bHQgPSBpbnB1dE1pbjtcbiAgICB9IGVsc2UgaWYgKGV4dHJhcG9sYXRlTGVmdCA9PT0gJ2V4dGVuZCcpIHtcbiAgICAgIC8vIG5vb3BcbiAgICB9XG4gIH1cblxuICBpZiAocmVzdWx0ID4gaW5wdXRNYXgpIHtcbiAgICBpZiAoZXh0cmFwb2xhdGVSaWdodCA9PT0gJ2lkZW50aXR5Jykge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGVsc2UgaWYgKGV4dHJhcG9sYXRlUmlnaHQgPT09ICdjbGFtcCcpIHtcbiAgICAgIHJlc3VsdCA9IGlucHV0TWF4O1xuICAgIH0gZWxzZSBpZiAoZXh0cmFwb2xhdGVSaWdodCA9PT0gJ2V4dGVuZCcpIHtcbiAgICAgIC8vIG5vb3BcbiAgICB9XG4gIH1cblxuICBpZiAob3V0cHV0TWluID09PSBvdXRwdXRNYXgpIHtcbiAgICByZXR1cm4gb3V0cHV0TWluO1xuICB9XG5cbiAgaWYgKGlucHV0TWluID09PSBpbnB1dE1heCkge1xuICAgIGlmIChpbnB1dCA8PSBpbnB1dE1pbikge1xuICAgICAgcmV0dXJuIG91dHB1dE1pbjtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dE1heDtcbiAgfVxuXG4gIC8vIElucHV0IFJhbmdlXG4gIGlmIChpbnB1dE1pbiA9PT0gLUluZmluaXR5KSB7XG4gICAgcmVzdWx0ID0gLXJlc3VsdDtcbiAgfSBlbHNlIGlmIChpbnB1dE1heCA9PT0gSW5maW5pdHkpIHtcbiAgICByZXN1bHQgPSByZXN1bHQgLSBpbnB1dE1pbjtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQgPSAocmVzdWx0IC0gaW5wdXRNaW4pIC8gKGlucHV0TWF4IC0gaW5wdXRNaW4pO1xuICB9XG5cbiAgLy8gRWFzaW5nXG4gIHJlc3VsdCA9IGVhc2luZyhyZXN1bHQpO1xuXG4gIC8vIE91dHB1dCBSYW5nZVxuICBpZiAob3V0cHV0TWluID09PSAtSW5maW5pdHkpIHtcbiAgICByZXN1bHQgPSAtcmVzdWx0O1xuICB9IGVsc2UgaWYgKG91dHB1dE1heCA9PT0gSW5maW5pdHkpIHtcbiAgICByZXN1bHQgPSByZXN1bHQgKyBvdXRwdXRNaW47XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gcmVzdWx0ICogKG91dHB1dE1heCAtIG91dHB1dE1pbikgKyBvdXRwdXRNaW47XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBjb2xvclRvUmdiYShpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgbGV0IGludDMyQ29sb3IgPSBub3JtYWxpemVDb2xvcihpbnB1dCk7XG4gIGlmIChpbnQzMkNvbG9yID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGlucHV0O1xuICB9XG5cbiAgaW50MzJDb2xvciA9IGludDMyQ29sb3IgfHwgMDtcblxuICBjb25zdCByID0gKGludDMyQ29sb3IgJiAweGZmMDAwMDAwKSA+Pj4gMjQ7XG4gIGNvbnN0IGcgPSAoaW50MzJDb2xvciAmIDB4MDBmZjAwMDApID4+PiAxNjtcbiAgY29uc3QgYiA9IChpbnQzMkNvbG9yICYgMHgwMDAwZmYwMCkgPj4+IDg7XG4gIGNvbnN0IGEgPSAoaW50MzJDb2xvciAmIDB4MDAwMDAwZmYpIC8gMjU1O1xuXG4gIHJldHVybiBgcmdiYSgke3J9LCAke2d9LCAke2J9LCAke2F9KWA7XG59XG5cbmNvbnN0IHN0cmluZ1NoYXBlUmVnZXggPSAvWzAtOVxcLi1dKy9nO1xuXG4vKipcbiAqIFN1cHBvcnRzIHN0cmluZyBzaGFwZXMgYnkgZXh0cmFjdGluZyBudW1iZXJzIHNvIG5ldyB2YWx1ZXMgY2FuIGJlIGNvbXB1dGVkLFxuICogYW5kIHJlY29tYmluZXMgdGhvc2UgdmFsdWVzIGludG8gbmV3IHN0cmluZ3Mgb2YgdGhlIHNhbWUgc2hhcGUuICBTdXBwb3J0c1xuICogdGhpbmdzIGxpa2U6XG4gKlxuICogICByZ2JhKDEyMywgNDIsIDk5LCAwLjM2KSAvLyBjb2xvcnNcbiAqICAgLTQ1ZGVnICAgICAgICAgICAgICAgICAgLy8gdmFsdWVzIHdpdGggdW5pdHNcbiAqL1xuZnVuY3Rpb24gY3JlYXRlSW50ZXJwb2xhdGlvbkZyb21TdHJpbmdPdXRwdXRSYW5nZShcbiAgY29uZmlnOiBJbnRlcnBvbGF0aW9uQ29uZmlnVHlwZSxcbik6IChpbnB1dDogbnVtYmVyKSA9PiBzdHJpbmcge1xuICBsZXQgb3V0cHV0UmFuZ2U6IEFycmF5PHN0cmluZz4gPSAoY29uZmlnLm91dHB1dFJhbmdlOiBhbnkpO1xuICBpbnZhcmlhbnQob3V0cHV0UmFuZ2UubGVuZ3RoID49IDIsICdCYWQgb3V0cHV0IHJhbmdlJyk7XG4gIG91dHB1dFJhbmdlID0gb3V0cHV0UmFuZ2UubWFwKGNvbG9yVG9SZ2JhKTtcbiAgY2hlY2tQYXR0ZXJuKG91dHB1dFJhbmdlKTtcblxuICAvLyBbJ3JnYmEoMCwgMTAwLCAyMDAsIDApJywgJ3JnYmEoNTAsIDE1MCwgMjUwLCAwLjUpJ11cbiAgLy8gLT5cbiAgLy8gW1xuICAvLyAgIFswLCA1MF0sXG4gIC8vICAgWzEwMCwgMTUwXSxcbiAgLy8gICBbMjAwLCAyNTBdLFxuICAvLyAgIFswLCAwLjVdLFxuICAvLyBdXG4gIC8qICRGbG93Rml4TWUoPj0wLjE4LjApOiBgb3V0cHV0UmFuZ2VbMF0ubWF0Y2goKWAgY2FuIHJldHVybiBgbnVsbGAuIE5lZWQgdG9cbiAgICogZ3VhcmQgYWdhaW5zdCB0aGlzIHBvc3NpYmlsaXR5LlxuICAgKi9cbiAgY29uc3Qgb3V0cHV0UmFuZ2VzID0gb3V0cHV0UmFuZ2VbMF0ubWF0Y2goc3RyaW5nU2hhcGVSZWdleCkubWFwKCgpID0+IFtdKTtcbiAgb3V0cHV0UmFuZ2UuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgLyogJEZsb3dGaXhNZSg+PTAuMTguMCk6IGB2YWx1ZS5tYXRjaCgpYCBjYW4gcmV0dXJuIGBudWxsYC4gTmVlZCB0byBndWFyZFxuICAgICAqIGFnYWluc3QgdGhpcyBwb3NzaWJpbGl0eS5cbiAgICAgKi9cbiAgICB2YWx1ZS5tYXRjaChzdHJpbmdTaGFwZVJlZ2V4KS5mb3JFYWNoKChudW1iZXIsIGkpID0+IHtcbiAgICAgIG91dHB1dFJhbmdlc1tpXS5wdXNoKCtudW1iZXIpO1xuICAgIH0pO1xuICB9KTtcblxuICAvKiAkRmxvd0ZpeE1lKD49MC4xOC4wKTogYG91dHB1dFJhbmdlWzBdLm1hdGNoKClgIGNhbiByZXR1cm4gYG51bGxgLiBOZWVkIHRvXG4gICAqIGd1YXJkIGFnYWluc3QgdGhpcyBwb3NzaWJpbGl0eS5cbiAgICovXG4gIGNvbnN0IGludGVycG9sYXRpb25zID0gb3V0cHV0UmFuZ2VbMF1cbiAgICAubWF0Y2goc3RyaW5nU2hhcGVSZWdleClcbiAgICAubWFwKCh2YWx1ZSwgaSkgPT4ge1xuICAgICAgcmV0dXJuIGNyZWF0ZUludGVycG9sYXRpb24oe1xuICAgICAgICAuLi5jb25maWcsXG4gICAgICAgIG91dHB1dFJhbmdlOiBvdXRwdXRSYW5nZXNbaV0sXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAvLyByZ2JhIHJlcXVpcmVzIHRoYXQgdGhlIHIsZyxiIGFyZSBpbnRlZ2Vycy4uLi4gc28gd2Ugd2FudCB0byByb3VuZCB0aGVtLCBidXQgd2UgKmRvbnQqIHdhbnQgdG9cbiAgLy8gcm91bmQgdGhlIG9wYWNpdHkgKDR0aCBjb2x1bW4pLlxuICBjb25zdCBzaG91bGRSb3VuZCA9IGlzUmdiT3JSZ2JhKG91dHB1dFJhbmdlWzBdKTtcblxuICByZXR1cm4gaW5wdXQgPT4ge1xuICAgIGxldCBpID0gMDtcbiAgICAvLyAncmdiYSgwLCAxMDAsIDIwMCwgMCknXG4gICAgLy8gLT5cbiAgICAvLyAncmdiYSgke2ludGVycG9sYXRpb25zWzBdKGlucHV0KX0sICR7aW50ZXJwb2xhdGlvbnNbMV0oaW5wdXQpfSwgLi4uJ1xuICAgIHJldHVybiBvdXRwdXRSYW5nZVswXS5yZXBsYWNlKHN0cmluZ1NoYXBlUmVnZXgsICgpID0+IHtcbiAgICAgIGNvbnN0IHZhbCA9ICtpbnRlcnBvbGF0aW9uc1tpKytdKGlucHV0KTtcbiAgICAgIGNvbnN0IHJvdW5kZWQgPVxuICAgICAgICBzaG91bGRSb3VuZCAmJiBpIDwgNCA/IE1hdGgucm91bmQodmFsKSA6IE1hdGgucm91bmQodmFsICogMTAwMCkgLyAxMDAwO1xuICAgICAgcmV0dXJuIFN0cmluZyhyb3VuZGVkKTtcbiAgICB9KTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNSZ2JPclJnYmEocmFuZ2UpIHtcbiAgcmV0dXJuIHR5cGVvZiByYW5nZSA9PT0gJ3N0cmluZycgJiYgcmFuZ2Uuc3RhcnRzV2l0aCgncmdiJyk7XG59XG5cbmZ1bmN0aW9uIGNoZWNrUGF0dGVybihhcnI6IEFycmF5PHN0cmluZz4pIHtcbiAgY29uc3QgcGF0dGVybiA9IGFyclswXS5yZXBsYWNlKHN0cmluZ1NoYXBlUmVnZXgsICcnKTtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBwYXR0ZXJuID09PSBhcnJbaV0ucmVwbGFjZShzdHJpbmdTaGFwZVJlZ2V4LCAnJyksXG4gICAgICAnaW52YWxpZCBwYXR0ZXJuICcgKyBhcnJbMF0gKyAnIGFuZCAnICsgYXJyW2ldLFxuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZFJhbmdlKGlucHV0OiBudW1iZXIsIGlucHV0UmFuZ2U6IEFycmF5PG51bWJlcj4pIHtcbiAgbGV0IGk7XG4gIGZvciAoaSA9IDE7IGkgPCBpbnB1dFJhbmdlLmxlbmd0aCAtIDE7ICsraSkge1xuICAgIGlmIChpbnB1dFJhbmdlW2ldID49IGlucHV0KSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGkgLSAxO1xufVxuXG5mdW5jdGlvbiBjaGVja1ZhbGlkSW5wdXRSYW5nZShhcnI6IEFycmF5PG51bWJlcj4pIHtcbiAgaW52YXJpYW50KGFyci5sZW5ndGggPj0gMiwgJ2lucHV0UmFuZ2UgbXVzdCBoYXZlIGF0IGxlYXN0IDIgZWxlbWVudHMnKTtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBhcnIubGVuZ3RoOyArK2kpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBhcnJbaV0gPj0gYXJyW2kgLSAxXSxcbiAgICAgIC8qICRGbG93Rml4TWUoPj0wLjEzLjApIC0gSW4gdGhlIGFkZGl0aW9uIGV4cHJlc3Npb24gYmVsb3cgdGhpcyBjb21tZW50LFxuICAgICAgICogb25lIG9yIGJvdGggb2YgdGhlIG9wZXJhbmRzIG1heSBiZSBzb21ldGhpbmcgdGhhdCBkb2Vzbid0IGNsZWFubHlcbiAgICAgICAqIGNvbnZlcnQgdG8gYSBzdHJpbmcsIGxpa2UgdW5kZWZpbmVkLCBudWxsLCBhbmQgb2JqZWN0LCBldGMuIElmIHlvdSByZWFsbHlcbiAgICAgICAqIG1lYW4gdGhpcyBpbXBsaWNpdCBzdHJpbmcgY29udmVyc2lvbiwgeW91IGNhbiBkbyBzb21ldGhpbmcgbGlrZVxuICAgICAgICogU3RyaW5nKG15VGhpbmcpXG4gICAgICAgKi9cbiAgICAgICdpbnB1dFJhbmdlIG11c3QgYmUgbW9ub3RvbmljYWxseSBpbmNyZWFzaW5nICcgKyBhcnIsXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjaGVja0luZmluaXRlUmFuZ2UobmFtZTogc3RyaW5nLCBhcnI6IEFycmF5PG51bWJlcj4pIHtcbiAgaW52YXJpYW50KGFyci5sZW5ndGggPj0gMiwgbmFtZSArICcgbXVzdCBoYXZlIGF0IGxlYXN0IDIgZWxlbWVudHMnKTtcbiAgaW52YXJpYW50KFxuICAgIGFyci5sZW5ndGggIT09IDIgfHwgYXJyWzBdICE9PSAtSW5maW5pdHkgfHwgYXJyWzFdICE9PSBJbmZpbml0eSxcbiAgICAvKiAkRmxvd0ZpeE1lKD49MC4xMy4wKSAtIEluIHRoZSBhZGRpdGlvbiBleHByZXNzaW9uIGJlbG93IHRoaXMgY29tbWVudCxcbiAgICAgKiBvbmUgb3IgYm90aCBvZiB0aGUgb3BlcmFuZHMgbWF5IGJlIHNvbWV0aGluZyB0aGF0IGRvZXNuJ3QgY2xlYW5seSBjb252ZXJ0XG4gICAgICogdG8gYSBzdHJpbmcsIGxpa2UgdW5kZWZpbmVkLCBudWxsLCBhbmQgb2JqZWN0LCBldGMuIElmIHlvdSByZWFsbHkgbWVhblxuICAgICAqIHRoaXMgaW1wbGljaXQgc3RyaW5nIGNvbnZlcnNpb24sIHlvdSBjYW4gZG8gc29tZXRoaW5nIGxpa2VcbiAgICAgKiBTdHJpbmcobXlUaGluZylcbiAgICAgKi9cbiAgICBuYW1lICsgJ2Nhbm5vdCBiZSBdLWluZmluaXR5OytpbmZpbml0eVsgJyArIGFycixcbiAgKTtcbn1cblxuY2xhc3MgQW5pbWF0ZWRJbnRlcnBvbGF0aW9uIGV4dGVuZHMgQW5pbWF0ZWRXaXRoQ2hpbGRyZW4ge1xuICAvLyBFeHBvcnQgZm9yIHRlc3RpbmcuXG4gIHN0YXRpYyBfX2NyZWF0ZUludGVycG9sYXRpb24gPSBjcmVhdGVJbnRlcnBvbGF0aW9uO1xuXG4gIF9wYXJlbnQ6IEFuaW1hdGVkTm9kZTtcbiAgX2NvbmZpZzogSW50ZXJwb2xhdGlvbkNvbmZpZ1R5cGU7XG4gIF9pbnRlcnBvbGF0aW9uOiAoaW5wdXQ6IG51bWJlcikgPT4gbnVtYmVyIHwgc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogQW5pbWF0ZWROb2RlLCBjb25maWc6IEludGVycG9sYXRpb25Db25maWdUeXBlKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9wYXJlbnQgPSBwYXJlbnQ7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMuX2ludGVycG9sYXRpb24gPSBjcmVhdGVJbnRlcnBvbGF0aW9uKGNvbmZpZyk7XG4gIH1cblxuICBfX21ha2VOYXRpdmUoKSB7XG4gICAgdGhpcy5fcGFyZW50Ll9fbWFrZU5hdGl2ZSgpO1xuICAgIHN1cGVyLl9fbWFrZU5hdGl2ZSgpO1xuICB9XG5cbiAgX19nZXRWYWx1ZSgpOiBudW1iZXIgfCBzdHJpbmcge1xuICAgIGNvbnN0IHBhcmVudFZhbHVlOiBudW1iZXIgPSB0aGlzLl9wYXJlbnQuX19nZXRWYWx1ZSgpO1xuICAgIGludmFyaWFudChcbiAgICAgIHR5cGVvZiBwYXJlbnRWYWx1ZSA9PT0gJ251bWJlcicsXG4gICAgICAnQ2Fubm90IGludGVycG9sYXRlIGFuIGlucHV0IHdoaWNoIGlzIG5vdCBhIG51bWJlci4nLFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuX2ludGVycG9sYXRpb24ocGFyZW50VmFsdWUpO1xuICB9XG5cbiAgaW50ZXJwb2xhdGUoY29uZmlnOiBJbnRlcnBvbGF0aW9uQ29uZmlnVHlwZSk6IEFuaW1hdGVkSW50ZXJwb2xhdGlvbiB7XG4gICAgcmV0dXJuIG5ldyBBbmltYXRlZEludGVycG9sYXRpb24odGhpcywgY29uZmlnKTtcbiAgfVxuXG4gIF9fYXR0YWNoKCk6IHZvaWQge1xuICAgIHRoaXMuX3BhcmVudC5fX2FkZENoaWxkKHRoaXMpO1xuICB9XG5cbiAgX19kZXRhY2goKTogdm9pZCB7XG4gICAgdGhpcy5fcGFyZW50Ll9fcmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgc3VwZXIuX19kZXRhY2goKTtcbiAgfVxuXG4gIF9fdHJhbnNmb3JtRGF0YVR5cGUocmFuZ2U6IEFycmF5PGFueT4pIHtcbiAgICAvLyBDaGFuZ2UgdGhlIHN0cmluZyBhcnJheSB0eXBlIHRvIG51bWJlciBhcnJheVxuICAgIC8vIFNvIHdlIGNhbiByZXVzZSB0aGUgc2FtZSBsb2dpYyBpbiBpT1MgYW5kIEFuZHJvaWQgcGxhdGZvcm1cbiAgICByZXR1cm4gcmFuZ2UubWFwKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBpZiAoL2RlZyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgIGNvbnN0IGRlZ3JlZXMgPSBwYXJzZUZsb2F0KHZhbHVlKSB8fCAwO1xuICAgICAgICBjb25zdCByYWRpYW5zID0gZGVncmVlcyAqIE1hdGguUEkgLyAxODAuMDtcbiAgICAgICAgcmV0dXJuIHJhZGlhbnM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBc3N1bWUgcmFkaWFuc1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCh2YWx1ZSkgfHwgMDtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIF9fZ2V0TmF0aXZlQ29uZmlnKCk6IGFueSB7XG4gICAgaWYgKF9fREVWX18pIHtcbiAgICAgIE5hdGl2ZUFuaW1hdGVkSGVscGVyLnZhbGlkYXRlSW50ZXJwb2xhdGlvbih0aGlzLl9jb25maWcpO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpbnB1dFJhbmdlOiB0aGlzLl9jb25maWcuaW5wdXRSYW5nZSxcbiAgICAgIC8vIE9ubHkgdGhlIGBvdXRwdXRSYW5nZWAgY2FuIGNvbnRhaW4gc3RyaW5ncyBzbyB3ZSBkb24ndCBuZWVkIHRvIHRyYW5mb3JtIGBpbnB1dFJhbmdlYCBoZXJlXG4gICAgICBvdXRwdXRSYW5nZTogdGhpcy5fX3RyYW5zZm9ybURhdGFUeXBlKHRoaXMuX2NvbmZpZy5vdXRwdXRSYW5nZSksXG4gICAgICBleHRyYXBvbGF0ZUxlZnQ6XG4gICAgICAgIHRoaXMuX2NvbmZpZy5leHRyYXBvbGF0ZUxlZnQgfHwgdGhpcy5fY29uZmlnLmV4dHJhcG9sYXRlIHx8ICdleHRlbmQnLFxuICAgICAgZXh0cmFwb2xhdGVSaWdodDpcbiAgICAgICAgdGhpcy5fY29uZmlnLmV4dHJhcG9sYXRlUmlnaHQgfHwgdGhpcy5fY29uZmlnLmV4dHJhcG9sYXRlIHx8ICdleHRlbmQnLFxuICAgICAgdHlwZTogJ2ludGVycG9sYXRpb24nLFxuICAgIH07XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBBbmltYXRlZEludGVycG9sYXRpb247XG4iXX0=