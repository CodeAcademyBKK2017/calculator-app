754fe31fd8973e301768b04cdb6a4a51













'use strict';

var AssetRegistry=require('AssetRegistry');
var AssetSourceResolver=require('AssetSourceResolver');
var NativeModules=require('NativeModules');



var _customSourceTransformer=void 0,_serverURL=void 0,_bundleSourceURL=void 0;

function getDevServerURL(){
if(_serverURL===undefined){
var scriptURL=NativeModules.SourceCode.scriptURL;
var match=scriptURL&&scriptURL.match(/^https?:\/\/.*?\//);
if(match){

_serverURL=match[0];
}else{

_serverURL=null;
}
}
return _serverURL;
}

function getBundleSourceURL(){
if(_bundleSourceURL===undefined){
var scriptURL=NativeModules.SourceCode.scriptURL;
if(!scriptURL){

_bundleSourceURL=null;
return _bundleSourceURL;
}
if(scriptURL.startsWith('assets://')){

_bundleSourceURL=null;
return _bundleSourceURL;
}
_bundleSourceURL=scriptURL.substring(0,scriptURL.lastIndexOf('/')+1);
if(!scriptURL.startsWith('file://')){


_bundleSourceURL='file://'+_bundleSourceURL;
}
}

return _bundleSourceURL;
}

function setCustomSourceTransformer(
transformer)
{
_customSourceTransformer=transformer;
}





function resolveAssetSource(source){
if(typeof source==='object'){
return source;
}

var asset=AssetRegistry.getAssetByID(source);
if(!asset){
return null;
}

var resolver=new AssetSourceResolver(getDevServerURL(),getBundleSourceURL(),asset);
if(_customSourceTransformer){
return _customSourceTransformer(resolver);
}
return resolver.defaultAsset();
}

module.exports=resolveAssetSource;
module.exports.pickScale=AssetSourceResolver.pickScale;
module.exports.setCustomSourceTransformer=setCustomSourceTransformer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc29sdmVBc3NldFNvdXJjZS5qcyJdLCJuYW1lcyI6WyJBc3NldFJlZ2lzdHJ5IiwicmVxdWlyZSIsIkFzc2V0U291cmNlUmVzb2x2ZXIiLCJOYXRpdmVNb2R1bGVzIiwiX2N1c3RvbVNvdXJjZVRyYW5zZm9ybWVyIiwiX3NlcnZlclVSTCIsIl9idW5kbGVTb3VyY2VVUkwiLCJnZXREZXZTZXJ2ZXJVUkwiLCJ1bmRlZmluZWQiLCJzY3JpcHRVUkwiLCJTb3VyY2VDb2RlIiwibWF0Y2giLCJnZXRCdW5kbGVTb3VyY2VVUkwiLCJzdGFydHNXaXRoIiwic3Vic3RyaW5nIiwibGFzdEluZGV4T2YiLCJzZXRDdXN0b21Tb3VyY2VUcmFuc2Zvcm1lciIsInRyYW5zZm9ybWVyIiwicmVzb2x2ZUFzc2V0U291cmNlIiwic291cmNlIiwiYXNzZXQiLCJnZXRBc3NldEJ5SUQiLCJyZXNvbHZlciIsImRlZmF1bHRBc3NldCIsIm1vZHVsZSIsImV4cG9ydHMiLCJwaWNrU2NhbGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFhQTs7QUFFQSxHQUFNQSxlQUFnQkMsUUFBUSxlQUFSLENBQXRCO0FBQ0EsR0FBTUMscUJBQXNCRCxRQUFRLHFCQUFSLENBQTVCO0FBQ0EsR0FBTUUsZUFBZ0JGLFFBQVEsZUFBUixDQUF0Qjs7OztBQUlBLEdBQUlHLGdDQUFKLENBQThCQyxpQkFBOUIsQ0FBMENDLHVCQUExQzs7QUFFQSxRQUFTQyxnQkFBVCxFQUFvQztBQUNsQyxHQUFJRixhQUFlRyxTQUFuQixDQUE4QjtBQUM1QixHQUFJQyxXQUFZTixjQUFjTyxVQUFkLENBQXlCRCxTQUF6QztBQUNBLEdBQUlFLE9BQVFGLFdBQWFBLFVBQVVFLEtBQVYsQ0FBZ0IsbUJBQWhCLENBQXpCO0FBQ0EsR0FBSUEsS0FBSixDQUFXOztBQUVUTixXQUFhTSxNQUFNLENBQU4sQ0FBYjtBQUNELENBSEQsSUFHTzs7QUFFTE4sV0FBYSxJQUFiO0FBQ0Q7QUFDRjtBQUNELE1BQU9BLFdBQVA7QUFDRDs7QUFFRCxRQUFTTyxtQkFBVCxFQUF1QztBQUNyQyxHQUFJTixtQkFBcUJFLFNBQXpCLENBQW9DO0FBQ2xDLEdBQU1DLFdBQVlOLGNBQWNPLFVBQWQsQ0FBeUJELFNBQTNDO0FBQ0EsR0FBSSxDQUFDQSxTQUFMLENBQWdCOztBQUVkSCxpQkFBbUIsSUFBbkI7QUFDQSxNQUFPQSxpQkFBUDtBQUNEO0FBQ0QsR0FBSUcsVUFBVUksVUFBVixDQUFxQixXQUFyQixDQUFKLENBQXVDOztBQUVyQ1AsaUJBQW1CLElBQW5CO0FBQ0EsTUFBT0EsaUJBQVA7QUFDRDtBQUNEQSxpQkFBbUJHLFVBQVVLLFNBQVYsQ0FBb0IsQ0FBcEIsQ0FBdUJMLFVBQVVNLFdBQVYsQ0FBc0IsR0FBdEIsRUFBNkIsQ0FBcEQsQ0FBbkI7QUFDQSxHQUFJLENBQUNOLFVBQVVJLFVBQVYsQ0FBcUIsU0FBckIsQ0FBTCxDQUFzQzs7O0FBR3BDUCxpQkFBbUIsVUFBWUEsZ0JBQS9CO0FBQ0Q7QUFDRjs7QUFFRCxNQUFPQSxpQkFBUDtBQUNEOztBQUVELFFBQVNVLDJCQUFUO0FBQ0VDLFdBREY7QUFFUTtBQUNOYix5QkFBMkJhLFdBQTNCO0FBQ0Q7Ozs7OztBQU1ELFFBQVNDLG1CQUFULENBQTRCQyxNQUE1QixDQUErRDtBQUM3RCxHQUFJLE1BQU9BLE9BQVAsR0FBa0IsUUFBdEIsQ0FBZ0M7QUFDOUIsTUFBT0EsT0FBUDtBQUNEOztBQUVELEdBQUlDLE9BQVFwQixjQUFjcUIsWUFBZCxDQUEyQkYsTUFBM0IsQ0FBWjtBQUNBLEdBQUksQ0FBQ0MsS0FBTCxDQUFZO0FBQ1YsTUFBTyxLQUFQO0FBQ0Q7O0FBRUQsR0FBTUUsVUFBVyxHQUFJcEIsb0JBQUosQ0FBd0JLLGlCQUF4QixDQUEyQ0ssb0JBQTNDLENBQWlFUSxLQUFqRSxDQUFqQjtBQUNBLEdBQUloQix3QkFBSixDQUE4QjtBQUM1QixNQUFPQSwwQkFBeUJrQixRQUF6QixDQUFQO0FBQ0Q7QUFDRCxNQUFPQSxVQUFTQyxZQUFULEVBQVA7QUFDRDs7QUFFREMsT0FBT0MsT0FBUCxDQUFpQlAsa0JBQWpCO0FBQ0FNLE9BQU9DLE9BQVAsQ0FBZUMsU0FBZixDQUEyQnhCLG9CQUFvQndCLFNBQS9DO0FBQ0FGLE9BQU9DLE9BQVAsQ0FBZVQsMEJBQWYsQ0FBNENBLDBCQUE1QyIsImZpbGUiOiJyZXNvbHZlQXNzZXRTb3VyY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIHJlc29sdmVBc3NldFNvdXJjZVxuICogQGZsb3dcbiAqXG4gKiBSZXNvbHZlcyBhbiBhc3NldCBpbnRvIGEgYHNvdXJjZWAgZm9yIGBJbWFnZWAuXG4gKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgQXNzZXRSZWdpc3RyeSA9IHJlcXVpcmUoJ0Fzc2V0UmVnaXN0cnknKTtcbmNvbnN0IEFzc2V0U291cmNlUmVzb2x2ZXIgPSByZXF1aXJlKCdBc3NldFNvdXJjZVJlc29sdmVyJyk7XG5jb25zdCBOYXRpdmVNb2R1bGVzID0gcmVxdWlyZSgnTmF0aXZlTW9kdWxlcycpO1xuXG5pbXBvcnQgdHlwZSB7IFJlc29sdmVkQXNzZXRTb3VyY2UgfSBmcm9tICdBc3NldFNvdXJjZVJlc29sdmVyJztcblxubGV0IF9jdXN0b21Tb3VyY2VUcmFuc2Zvcm1lciwgX3NlcnZlclVSTCwgX2J1bmRsZVNvdXJjZVVSTDtcblxuZnVuY3Rpb24gZ2V0RGV2U2VydmVyVVJMKCk6ID9zdHJpbmcge1xuICBpZiAoX3NlcnZlclVSTCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdmFyIHNjcmlwdFVSTCA9IE5hdGl2ZU1vZHVsZXMuU291cmNlQ29kZS5zY3JpcHRVUkw7XG4gICAgdmFyIG1hdGNoID0gc2NyaXB0VVJMICYmIHNjcmlwdFVSTC5tYXRjaCgvXmh0dHBzPzpcXC9cXC8uKj9cXC8vKTtcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIC8vIEJ1bmRsZSB3YXMgbG9hZGVkIGZyb20gbmV0d29ya1xuICAgICAgX3NlcnZlclVSTCA9IG1hdGNoWzBdO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBCdW5kbGUgd2FzIGxvYWRlZCBmcm9tIGZpbGVcbiAgICAgIF9zZXJ2ZXJVUkwgPSBudWxsO1xuICAgIH1cbiAgfVxuICByZXR1cm4gX3NlcnZlclVSTDtcbn1cblxuZnVuY3Rpb24gZ2V0QnVuZGxlU291cmNlVVJMKCk6ID9zdHJpbmcge1xuICBpZiAoX2J1bmRsZVNvdXJjZVVSTCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3Qgc2NyaXB0VVJMID0gTmF0aXZlTW9kdWxlcy5Tb3VyY2VDb2RlLnNjcmlwdFVSTDtcbiAgICBpZiAoIXNjcmlwdFVSTCkge1xuICAgICAgLy8gc2NyaXB0VVJMIGlzIGZhbHN5LCB3ZSBoYXZlIG5vdGhpbmcgdG8gZ28gb24gaGVyZVxuICAgICAgX2J1bmRsZVNvdXJjZVVSTCA9IG51bGw7XG4gICAgICByZXR1cm4gX2J1bmRsZVNvdXJjZVVSTDtcbiAgICB9XG4gICAgaWYgKHNjcmlwdFVSTC5zdGFydHNXaXRoKCdhc3NldHM6Ly8nKSkge1xuICAgICAgLy8gYW5kcm9pZDogcnVubmluZyBmcm9tIHdpdGhpbiBhc3NldHMsIG5vIG9mZmxpbmUgcGF0aCB0byB1c2VcbiAgICAgIF9idW5kbGVTb3VyY2VVUkwgPSBudWxsO1xuICAgICAgcmV0dXJuIF9idW5kbGVTb3VyY2VVUkw7XG4gICAgfVxuICAgIF9idW5kbGVTb3VyY2VVUkwgPSBzY3JpcHRVUkwuc3Vic3RyaW5nKDAsIHNjcmlwdFVSTC5sYXN0SW5kZXhPZignLycpICsgMSk7XG4gICAgaWYgKCFzY3JpcHRVUkwuc3RhcnRzV2l0aCgnZmlsZTovLycpKSB7XG4gICAgICAvLyBBZGQgZmlsZSBwcm90b2NvbCBpbiBjYXNlIHdlIGhhdmUgYW4gYWJzb2x1dGUgZmlsZSBwYXRoIGFuZCBub3QgYSBVUkwuXG4gICAgICAvLyBUaGlzIHNob3VsZG4ndCByZWFsbHkgYmUgbmVjZXNzYXJ5LiBzY3JpcHRVUkwgc2hvdWxkIGJlIGEgVVJMLlxuICAgICAgX2J1bmRsZVNvdXJjZVVSTCA9ICdmaWxlOi8vJyArIF9idW5kbGVTb3VyY2VVUkw7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIF9idW5kbGVTb3VyY2VVUkw7XG59XG5cbmZ1bmN0aW9uIHNldEN1c3RvbVNvdXJjZVRyYW5zZm9ybWVyKFxuICB0cmFuc2Zvcm1lcjogKHJlc29sdmVyOiBBc3NldFNvdXJjZVJlc29sdmVyKSA9PiBSZXNvbHZlZEFzc2V0U291cmNlLFxuKTogdm9pZCB7XG4gIF9jdXN0b21Tb3VyY2VUcmFuc2Zvcm1lciA9IHRyYW5zZm9ybWVyO1xufVxuXG4vKipcbiAqIGBzb3VyY2VgIGlzIGVpdGhlciBhIG51bWJlciAob3BhcXVlIHR5cGUgcmV0dXJuZWQgYnkgcmVxdWlyZSgnLi9mb28ucG5nJykpXG4gKiBvciBhbiBgSW1hZ2VTb3VyY2VgIGxpa2UgeyB1cmk6ICc8aHR0cCBsb2NhdGlvbiB8fCBmaWxlIHBhdGg+JyB9XG4gKi9cbmZ1bmN0aW9uIHJlc29sdmVBc3NldFNvdXJjZShzb3VyY2U6IGFueSk6ID9SZXNvbHZlZEFzc2V0U291cmNlIHtcbiAgaWYgKHR5cGVvZiBzb3VyY2UgPT09ICdvYmplY3QnKSB7XG4gICAgcmV0dXJuIHNvdXJjZTtcbiAgfVxuXG4gIHZhciBhc3NldCA9IEFzc2V0UmVnaXN0cnkuZ2V0QXNzZXRCeUlEKHNvdXJjZSk7XG4gIGlmICghYXNzZXQpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHJlc29sdmVyID0gbmV3IEFzc2V0U291cmNlUmVzb2x2ZXIoZ2V0RGV2U2VydmVyVVJMKCksIGdldEJ1bmRsZVNvdXJjZVVSTCgpLCBhc3NldCk7XG4gIGlmIChfY3VzdG9tU291cmNlVHJhbnNmb3JtZXIpIHtcbiAgICByZXR1cm4gX2N1c3RvbVNvdXJjZVRyYW5zZm9ybWVyKHJlc29sdmVyKTtcbiAgfVxuICByZXR1cm4gcmVzb2x2ZXIuZGVmYXVsdEFzc2V0KCk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVzb2x2ZUFzc2V0U291cmNlO1xubW9kdWxlLmV4cG9ydHMucGlja1NjYWxlID0gQXNzZXRTb3VyY2VSZXNvbHZlci5waWNrU2NhbGU7XG5tb2R1bGUuZXhwb3J0cy5zZXRDdXN0b21Tb3VyY2VUcmFuc2Zvcm1lciA9IHNldEN1c3RvbVNvdXJjZVRyYW5zZm9ybWVyO1xuIl19