d1834ad7884adf85b4c2d05ad2bde0d4












'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var _require=

require('./AnimatedEvent'),AnimatedEvent=_require.AnimatedEvent;
var AnimatedProps=require('./nodes/AnimatedProps');
var React=require('React');
var ViewStylePropTypes=require('ViewStylePropTypes');

function createAnimatedComponent(Component){var
AnimatedComponent=function(_React$Component){_inherits(AnimatedComponent,_React$Component);








function AnimatedComponent(props){_classCallCheck(this,AnimatedComponent);var _this=_possibleConstructorReturn(this,(AnimatedComponent.__proto__||Object.getPrototypeOf(AnimatedComponent)).call(this,
props));_this._eventDetachers=[];
_this._setComponentRef=_this._setComponentRef.bind(_this);return _this;
}_createClass(AnimatedComponent,[{key:'componentWillUnmount',value:function componentWillUnmount()

{
this._propsAnimated&&this._propsAnimated.__detach();
this._detachNativeEvents();
}},{key:'setNativeProps',value:function setNativeProps(

props){
this._component.setNativeProps(props);
}},{key:'componentWillMount',value:function componentWillMount()

{
this._attachProps(this.props);
}},{key:'componentDidMount',value:function componentDidMount()

{
this._propsAnimated.setNativeView(this._component);
this._attachNativeEvents();
}},{key:'_attachNativeEvents',value:function _attachNativeEvents()

{var _this2=this;


var scrollableNode=this._component.getScrollableNode?
this._component.getScrollableNode():
this._component;var _loop=function _loop(

key){
var prop=_this2.props[key];
if(prop instanceof AnimatedEvent&&prop.__isNative){
prop.__attach(scrollableNode,key);
_this2._eventDetachers.push(function(){return prop.__detach(scrollableNode,key);});
}};for(var key in this.props){_loop(key);
}
}},{key:'_detachNativeEvents',value:function _detachNativeEvents()

{
this._eventDetachers.forEach(function(remove){return remove();});
this._eventDetachers=[];
}},{key:'_attachProps',value:function _attachProps(

nextProps){var _this3=this;
var oldPropsAnimated=this._propsAnimated;







var callback=function callback(){
if(
!AnimatedComponent.__skipSetNativeProps_FOR_TESTS_ONLY&&
_this3._component.setNativeProps)
{
if(!_this3._propsAnimated.__isNative){
_this3._component.setNativeProps(
_this3._propsAnimated.__getAnimatedValue());

}else{
throw new Error(
'Attempting to run JS driven animation on animated '+
'node that has been moved to "native" earlier by starting an '+
'animation with `useNativeDriver: true`');

}
}else{
_this3.forceUpdate();
}
};

this._propsAnimated=new AnimatedProps(nextProps,callback);









oldPropsAnimated&&oldPropsAnimated.__detach();
}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(

newProps){
this._attachProps(newProps);
}},{key:'componentDidUpdate',value:function componentDidUpdate(

prevProps){
if(this._component!==this._prevComponent){
this._propsAnimated.setNativeView(this._component);
}
if(this._component!==this._prevComponent||prevProps!==this.props){
this._detachNativeEvents();
this._attachNativeEvents();
}
}},{key:'render',value:function render()

{
var props=this._propsAnimated.__getValue();
return(
React.createElement(Component,_extends({},
props,{
ref:this._setComponentRef,




collapsable:
this._propsAnimated.__isNative?false:props.collapsable})));



}},{key:'_setComponentRef',value:function _setComponentRef(

c){
this._prevComponent=this._component;
this._component=c;
}},{key:'getNode',value:function getNode()



{
return this._component;
}}]);return AnimatedComponent;}(React.Component);AnimatedComponent.__skipSetNativeProps_FOR_TESTS_ONLY=false;







var propTypes=
Component.__propTypesSecretDontUseThesePlease||Component.propTypes;

AnimatedComponent.propTypes={
style:function style(props,propName,componentName){
if(!propTypes){
return;
}

for(var key in ViewStylePropTypes){
if(!propTypes[key]&&props[key]!==undefined){
console.warn(
'You are setting the style `{ '+
key+
': ... }` as a prop. You '+
'should nest it in a style object. '+
'E.g. `{ style: { '+
key+
': ... } }`');

}
}
}};


return AnimatedComponent;
}

module.exports=createAnimatedComponent;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyZWF0ZUFuaW1hdGVkQ29tcG9uZW50LmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJBbmltYXRlZEV2ZW50IiwiQW5pbWF0ZWRQcm9wcyIsIlJlYWN0IiwiVmlld1N0eWxlUHJvcFR5cGVzIiwiY3JlYXRlQW5pbWF0ZWRDb21wb25lbnQiLCJDb21wb25lbnQiLCJBbmltYXRlZENvbXBvbmVudCIsInByb3BzIiwiX2V2ZW50RGV0YWNoZXJzIiwiX3NldENvbXBvbmVudFJlZiIsImJpbmQiLCJfcHJvcHNBbmltYXRlZCIsIl9fZGV0YWNoIiwiX2RldGFjaE5hdGl2ZUV2ZW50cyIsIl9jb21wb25lbnQiLCJzZXROYXRpdmVQcm9wcyIsIl9hdHRhY2hQcm9wcyIsInNldE5hdGl2ZVZpZXciLCJfYXR0YWNoTmF0aXZlRXZlbnRzIiwic2Nyb2xsYWJsZU5vZGUiLCJnZXRTY3JvbGxhYmxlTm9kZSIsImtleSIsInByb3AiLCJfX2lzTmF0aXZlIiwiX19hdHRhY2giLCJwdXNoIiwiZm9yRWFjaCIsInJlbW92ZSIsIm5leHRQcm9wcyIsIm9sZFByb3BzQW5pbWF0ZWQiLCJjYWxsYmFjayIsIl9fc2tpcFNldE5hdGl2ZVByb3BzX0ZPUl9URVNUU19PTkxZIiwiX19nZXRBbmltYXRlZFZhbHVlIiwiRXJyb3IiLCJmb3JjZVVwZGF0ZSIsIm5ld1Byb3BzIiwicHJldlByb3BzIiwiX3ByZXZDb21wb25lbnQiLCJfX2dldFZhbHVlIiwiY29sbGFwc2FibGUiLCJjIiwicHJvcFR5cGVzIiwiX19wcm9wVHlwZXNTZWNyZXREb250VXNlVGhlc2VQbGVhc2UiLCJzdHlsZSIsInByb3BOYW1lIiwiY29tcG9uZW50TmFtZSIsInVuZGVmaW5lZCIsImNvbnNvbGUiLCJ3YXJuIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBWUEsYTs7QUFFd0JBLFFBQVEsaUJBQVIsQyxDQUFqQkMsYSxVQUFBQSxhO0FBQ1AsR0FBTUMsZUFBZ0JGLFFBQVEsdUJB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RSwwQkFGRjtBQUdFLG9DQUhGO0FBSUUsbUJBSkY7QUFLRUEsR0FMRjtBQU1FLFlBUEo7O0FBU0Q7QUFDRjtBQUNGLENBbkIyQixDQUE5Qjs7O0FBc0JBLE1BQU9mLGtCQUFQO0FBQ0Q7O0FBRUQyQyxPQUFPQyxPQUFQLENBQWlCOUMsdUJBQWpCIiwiZmlsZSI6ImNyZWF0ZUFuaW1hdGVkQ29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBjcmVhdGVBbmltYXRlZENvbXBvbmVudFxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCB7QW5pbWF0ZWRFdmVudH0gPSByZXF1aXJlKCcuL0FuaW1hdGVkRXZlbnQnKTtcbmNvbnN0IEFuaW1hdGVkUHJvcHMgPSByZXF1aXJlKCcuL25vZGVzL0FuaW1hdGVkUHJvcHMnKTtcbmNvbnN0IFJlYWN0ID0gcmVxdWlyZSgnUmVhY3QnKTtcbmNvbnN0IFZpZXdTdHlsZVByb3BUeXBlcyA9IHJlcXVpcmUoJ1ZpZXdTdHlsZVByb3BUeXBlcycpO1xuXG5mdW5jdGlvbiBjcmVhdGVBbmltYXRlZENvbXBvbmVudChDb21wb25lbnQ6IGFueSk6IGFueSB7XG4gIGNsYXNzIEFuaW1hdGVkQ29tcG9uZW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PE9iamVjdD4ge1xuICAgIF9jb21wb25lbnQ6IGFueTtcbiAgICBfcHJldkNvbXBvbmVudDogYW55O1xuICAgIF9wcm9wc0FuaW1hdGVkOiBBbmltYXRlZFByb3BzO1xuICAgIF9ldmVudERldGFjaGVyczogQXJyYXk8RnVuY3Rpb24+ID0gW107XG4gICAgX3NldENvbXBvbmVudFJlZjogRnVuY3Rpb247XG5cbiAgICBzdGF0aWMgX19za2lwU2V0TmF0aXZlUHJvcHNfRk9SX1RFU1RTX09OTFkgPSBmYWxzZTtcblxuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBPYmplY3QpIHtcbiAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgIHRoaXMuX3NldENvbXBvbmVudFJlZiA9IHRoaXMuX3NldENvbXBvbmVudFJlZi5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgdGhpcy5fcHJvcHNBbmltYXRlZCAmJiB0aGlzLl9wcm9wc0FuaW1hdGVkLl9fZGV0YWNoKCk7XG4gICAgICB0aGlzLl9kZXRhY2hOYXRpdmVFdmVudHMoKTtcbiAgICB9XG5cbiAgICBzZXROYXRpdmVQcm9wcyhwcm9wcykge1xuICAgICAgdGhpcy5fY29tcG9uZW50LnNldE5hdGl2ZVByb3BzKHByb3BzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsTW91bnQoKSB7XG4gICAgICB0aGlzLl9hdHRhY2hQcm9wcyh0aGlzLnByb3BzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgIHRoaXMuX3Byb3BzQW5pbWF0ZWQuc2V0TmF0aXZlVmlldyh0aGlzLl9jb21wb25lbnQpO1xuICAgICAgdGhpcy5fYXR0YWNoTmF0aXZlRXZlbnRzKCk7XG4gICAgfVxuXG4gICAgX2F0dGFjaE5hdGl2ZUV2ZW50cygpIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSB0byBnZXQgdGhlIHNjcm9sbGFibGUgbm9kZSBmb3IgY29tcG9uZW50cyB0aGF0IGltcGxlbWVudFxuICAgICAgLy8gYFNjcm9sbFJlc3BvbmRlci5NaXhpbmAuXG4gICAgICBjb25zdCBzY3JvbGxhYmxlTm9kZSA9IHRoaXMuX2NvbXBvbmVudC5nZXRTY3JvbGxhYmxlTm9kZVxuICAgICAgICA/IHRoaXMuX2NvbXBvbmVudC5nZXRTY3JvbGxhYmxlTm9kZSgpXG4gICAgICAgIDogdGhpcy5fY29tcG9uZW50O1xuXG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLnByb3BzKSB7XG4gICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnByb3BzW2tleV07XG4gICAgICAgIGlmIChwcm9wIGluc3RhbmNlb2YgQW5pbWF0ZWRFdmVudCAmJiBwcm9wLl9faXNOYXRpdmUpIHtcbiAgICAgICAgICBwcm9wLl9fYXR0YWNoKHNjcm9sbGFibGVOb2RlLCBrZXkpO1xuICAgICAgICAgIHRoaXMuX2V2ZW50RGV0YWNoZXJzLnB1c2goKCkgPT4gcHJvcC5fX2RldGFjaChzY3JvbGxhYmxlTm9kZSwga2V5KSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBfZGV0YWNoTmF0aXZlRXZlbnRzKCkge1xuICAgICAgdGhpcy5fZXZlbnREZXRhY2hlcnMuZm9yRWFjaChyZW1vdmUgPT4gcmVtb3ZlKCkpO1xuICAgICAgdGhpcy5fZXZlbnREZXRhY2hlcnMgPSBbXTtcbiAgICB9XG5cbiAgICBfYXR0YWNoUHJvcHMobmV4dFByb3BzKSB7XG4gICAgICBjb25zdCBvbGRQcm9wc0FuaW1hdGVkID0gdGhpcy5fcHJvcHNBbmltYXRlZDtcblxuICAgICAgLy8gVGhlIHN5c3RlbSBpcyBiZXN0IGRlc2lnbmVkIHdoZW4gc2V0TmF0aXZlUHJvcHMgaXMgaW1wbGVtZW50ZWQuIEl0IGlzXG4gICAgICAvLyBhYmxlIHRvIGF2b2lkIHJlLXJlbmRlcmluZyBhbmQgZGlyZWN0bHkgc2V0IHRoZSBhdHRyaWJ1dGVzIHRoYXRcbiAgICAgIC8vIGNoYW5nZWQuIEhvd2V2ZXIsIHNldE5hdGl2ZVByb3BzIGNhbiBvbmx5IGJlIGltcGxlbWVudGVkIG9uIGxlYWZcbiAgICAgIC8vIG5hdGl2ZSBjb21wb25lbnRzLiBJZiB5b3Ugd2FudCB0byBhbmltYXRlIGEgY29tcG9zaXRlIGNvbXBvbmVudCwgeW91XG4gICAgICAvLyBuZWVkIHRvIHJlLXJlbmRlciBpdC4gSW4gdGhpcyBjYXNlLCB3ZSBoYXZlIGEgZmFsbGJhY2sgdGhhdCB1c2VzXG4gICAgICAvLyBmb3JjZVVwZGF0ZS5cbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgIUFuaW1hdGVkQ29tcG9uZW50Ll9fc2tpcFNldE5hdGl2ZVByb3BzX0ZPUl9URVNUU19PTkxZICYmXG4gICAgICAgICAgdGhpcy5fY29tcG9uZW50LnNldE5hdGl2ZVByb3BzXG4gICAgICAgICkge1xuICAgICAgICAgIGlmICghdGhpcy5fcHJvcHNBbmltYXRlZC5fX2lzTmF0aXZlKSB7XG4gICAgICAgICAgICB0aGlzLl9jb21wb25lbnQuc2V0TmF0aXZlUHJvcHMoXG4gICAgICAgICAgICAgIHRoaXMuX3Byb3BzQW5pbWF0ZWQuX19nZXRBbmltYXRlZFZhbHVlKCksXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICdBdHRlbXB0aW5nIHRvIHJ1biBKUyBkcml2ZW4gYW5pbWF0aW9uIG9uIGFuaW1hdGVkICcgK1xuICAgICAgICAgICAgICAgICdub2RlIHRoYXQgaGFzIGJlZW4gbW92ZWQgdG8gXCJuYXRpdmVcIiBlYXJsaWVyIGJ5IHN0YXJ0aW5nIGFuICcgK1xuICAgICAgICAgICAgICAgICdhbmltYXRpb24gd2l0aCBgdXNlTmF0aXZlRHJpdmVyOiB0cnVlYCcsXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX3Byb3BzQW5pbWF0ZWQgPSBuZXcgQW5pbWF0ZWRQcm9wcyhuZXh0UHJvcHMsIGNhbGxiYWNrKTtcblxuICAgICAgLy8gV2hlbiB5b3UgY2FsbCBkZXRhY2gsIGl0IHJlbW92ZXMgdGhlIGVsZW1lbnQgZnJvbSB0aGUgcGFyZW50IGxpc3RcbiAgICAgIC8vIG9mIGNoaWxkcmVuLiBJZiBpdCBnb2VzIHRvIDAsIHRoZW4gdGhlIHBhcmVudCBhbHNvIGRldGFjaGVzIGl0c2VsZlxuICAgICAgLy8gYW5kIHNvIG9uLlxuICAgICAgLy8gQW4gb3B0aW1pemF0aW9uIGlzIHRvIGF0dGFjaCB0aGUgbmV3IGVsZW1lbnRzIGFuZCBUSEVOIGRldGFjaCB0aGUgb2xkXG4gICAgICAvLyBvbmVzIGluc3RlYWQgb2YgZGV0YWNoaW5nIGFuZCBUSEVOIGF0dGFjaGluZy5cbiAgICAgIC8vIFRoaXMgd2F5IHRoZSBpbnRlcm1lZGlhdGUgc3RhdGUgaXNuJ3QgdG8gZ28gdG8gMCBhbmQgdHJpZ2dlclxuICAgICAgLy8gdGhpcyBleHBlbnNpdmUgcmVjdXJzaXZlIGRldGFjaGluZyB0byB0aGVuIHJlLWF0dGFjaCBldmVyeXRoaW5nIG9uXG4gICAgICAvLyB0aGUgdmVyeSBuZXh0IG9wZXJhdGlvbi5cbiAgICAgIG9sZFByb3BzQW5pbWF0ZWQgJiYgb2xkUHJvcHNBbmltYXRlZC5fX2RldGFjaCgpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV3UHJvcHMpIHtcbiAgICAgIHRoaXMuX2F0dGFjaFByb3BzKG5ld1Byb3BzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgICBpZiAodGhpcy5fY29tcG9uZW50ICE9PSB0aGlzLl9wcmV2Q29tcG9uZW50KSB7XG4gICAgICAgIHRoaXMuX3Byb3BzQW5pbWF0ZWQuc2V0TmF0aXZlVmlldyh0aGlzLl9jb21wb25lbnQpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuX2NvbXBvbmVudCAhPT0gdGhpcy5fcHJldkNvbXBvbmVudCB8fCBwcmV2UHJvcHMgIT09IHRoaXMucHJvcHMpIHtcbiAgICAgICAgdGhpcy5fZGV0YWNoTmF0aXZlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX2F0dGFjaE5hdGl2ZUV2ZW50cygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgIGNvbnN0IHByb3BzID0gdGhpcy5fcHJvcHNBbmltYXRlZC5fX2dldFZhbHVlKCk7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8Q29tcG9uZW50XG4gICAgICAgICAgey4uLnByb3BzfVxuICAgICAgICAgIHJlZj17dGhpcy5fc2V0Q29tcG9uZW50UmVmfVxuICAgICAgICAgIC8vIFRoZSBuYXRpdmUgZHJpdmVyIHVwZGF0ZXMgdmlld3MgZGlyZWN0bHkgdGhyb3VnaCB0aGUgVUkgdGhyZWFkIHNvIHdlXG4gICAgICAgICAgLy8gaGF2ZSB0byBtYWtlIHN1cmUgdGhlIHZpZXcgZG9lc24ndCBnZXQgb3B0aW1pemVkIGF3YXkgYmVjYXVzZSBpdCBjYW5ub3RcbiAgICAgICAgICAvLyBnbyB0aHJvdWdoIHRoZSBOYXRpdmVWaWV3SGllcmFjaHlNYW5hZ2VyIHNpbmNlIGl0IG9wZXJhdGVzIG9uIHRoZSBzaGFkb3dcbiAgICAgICAgICAvLyB0aHJlYWQuXG4gICAgICAgICAgY29sbGFwc2FibGU9e1xuICAgICAgICAgICAgdGhpcy5fcHJvcHNBbmltYXRlZC5fX2lzTmF0aXZlID8gZmFsc2UgOiBwcm9wcy5jb2xsYXBzYWJsZVxuICAgICAgICAgIH1cbiAgICAgICAgLz5cbiAgICAgICk7XG4gICAgfVxuXG4gICAgX3NldENvbXBvbmVudFJlZihjKSB7XG4gICAgICB0aGlzLl9wcmV2Q29tcG9uZW50ID0gdGhpcy5fY29tcG9uZW50O1xuICAgICAgdGhpcy5fY29tcG9uZW50ID0gYztcbiAgICB9XG5cbiAgICAvLyBBIHRoaXJkIHBhcnR5IGxpYnJhcnkgY2FuIHVzZSBnZXROb2RlKClcbiAgICAvLyB0byBnZXQgdGhlIG5vZGUgcmVmZXJlbmNlIG9mIHRoZSBkZWNvcmF0ZWQgY29tcG9uZW50XG4gICAgZ2V0Tm9kZSgpIHtcbiAgICAgIHJldHVybiB0aGlzLl9jb21wb25lbnQ7XG4gICAgfVxuICB9XG5cbiAgLy8gUmVhY3ROYXRpdmUgYFZpZXcucHJvcFR5cGVzYCBoYXZlIGJlZW4gZGVwcmVjYXRlZCBpbiBmYXZvciBvZlxuICAvLyBgVmlld1Byb3BUeXBlc2AuIEluIHRoZWlyIHBsYWNlIGEgdGVtcG9yYXJ5IGdldHRlciBoYXMgYmVlbiBhZGRlZCB3aXRoIGFcbiAgLy8gZGVwcmVjYXRlZCB3YXJuaW5nIG1lc3NhZ2UuIEF2b2lkIHRyaWdnZXJpbmcgdGhhdCB3YXJuaW5nIGhlcmUgYnkgdXNpbmdcbiAgLy8gdGVtcG9yYXJ5IHdvcmthcm91bmQsIF9fcHJvcFR5cGVzU2VjcmV0RG9udFVzZVRoZXNlUGxlYXNlLlxuICAvLyBUT0RPIChidmF1Z2huKSBSZXZlcnQgdGhpcyBwYXJ0aWN1bGFyIGNoYW5nZSBhbnkgdGltZSBhZnRlciBBcHJpbCAxXG4gIGNvbnN0IHByb3BUeXBlcyA9XG4gICAgQ29tcG9uZW50Ll9fcHJvcFR5cGVzU2VjcmV0RG9udFVzZVRoZXNlUGxlYXNlIHx8IENvbXBvbmVudC5wcm9wVHlwZXM7XG5cbiAgQW5pbWF0ZWRDb21wb25lbnQucHJvcFR5cGVzID0ge1xuICAgIHN0eWxlOiBmdW5jdGlvbihwcm9wcywgcHJvcE5hbWUsIGNvbXBvbmVudE5hbWUpIHtcbiAgICAgIGlmICghcHJvcFR5cGVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChjb25zdCBrZXkgaW4gVmlld1N0eWxlUHJvcFR5cGVzKSB7XG4gICAgICAgIGlmICghcHJvcFR5cGVzW2tleV0gJiYgcHJvcHNba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgJ1lvdSBhcmUgc2V0dGluZyB0aGUgc3R5bGUgYHsgJyArXG4gICAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICAgICc6IC4uLiB9YCBhcyBhIHByb3AuIFlvdSAnICtcbiAgICAgICAgICAgICAgJ3Nob3VsZCBuZXN0IGl0IGluIGEgc3R5bGUgb2JqZWN0LiAnICtcbiAgICAgICAgICAgICAgJ0UuZy4gYHsgc3R5bGU6IHsgJyArXG4gICAgICAgICAgICAgIGtleSArXG4gICAgICAgICAgICAgICc6IC4uLiB9IH1gJyxcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgfTtcblxuICByZXR1cm4gQW5pbWF0ZWRDb21wb25lbnQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlQW5pbWF0ZWRDb21wb25lbnQ7XG4iXX0=